<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<h1 id="anonymous-proof-of-possession-in-the-context-of-diplomata-record-ledger-uc3">Anonymous Proof of Possession in the context of Diplomata Record Ledger (UC3)</h1>
<h2 id="introduction">Introduction</h2>
<p><em>Diplomata</em> is a proposed system for proving and verifying title possession in a privacy-preserving fashion. It involves three kinds of interacting network entities: <em>Holders</em> of qualifications, which they can present to interested parties, <em>Issuers</em> capable of issuing qualifications to holders, and <em>Verifiers</em> able to verify the holders' claims of possessing a title. Awarding of titles, requests of certification, acknowledgments of certification etc. are all recorded in the form of transaction in a blockchain ledger, in order for the involved entities to be held publicly accountable for their actions. Requirements like <em>access control</em> on behalf of the holders, resistance to <em>no honesty</em> and <em>auditability</em> by external observers are also satisfied.</p>
<p>A protocol (<em>ZK-Decryptor Protocol</em>) has already been proposed on top of an El-Gamal cryptosystem, that allows holders to (indirectly) prove possession of titles to verifiers. However, the Issuer of the title is heavily involved in the process. Except for an initial certification request and the private communication of the corresponding commitment to the Verifier, the rest of communication takes place between Issuer and Verifier: it is the <em>Issuer</em> who generates the proof of award that will be finally verified. More importantly, verification of proof presupposes that the (content of the) title will finally be <em>disclosed</em> to the Verifier, i.e., &quot;zero-knowledge&quot; does not refer to the qualification itself. Since the title contains as such reference to the Holder's identity, this entails <em>non</em>-anonymity for the Holder.</p>
<p>Purpose of this text is to propose an alternative to the <em>ZK-Decryptor</em> protocol for the case where the Holder's anonymity is desired and the (content of the) title should not be revealed. This pertains to the following meritocratic scenario: Holder and Verifier meet anonymously online and the Holder wishes to prove <em>for themselves</em> possession of a title</p>
<ol style="list-style-type: decimal">
<li>without revealing their identity (public key)</li>
<li>without disclosing any info about the title, except for the claim that it exists among their acquired qualifications</li>
<li>in one single communication step</li>
<li>without involvement of anybody else in that step (say, the Issuer of the title)</li>
</ol>
<p>The proposed protocol will be referred to as <em>Anonymous Proof of Possession Protocol</em>. Proof of possession should be thought of as proof of <em>inclusion</em> in a set of recordedly awarded titles (possibly of a special kind) correlated to the prover's (unrevealed) public key -without further reference. In doing so, we employ the <em>zk-SNARK</em> cryptographic scheme combined with a commitment mechanism on top of the already available El-Gamal cryptosystem. Such a construction will partly resemble the <em>ZeroCash</em> anonymous payment scheme, with each title interpreted as 1 BTC (bitcoin) and the holders' commitments to serial numbers being recorded in the public ledger. There are however two major differences:</p>
<ol style="list-style-type: decimal">
<li><p>No &quot;Direct Anonymous Payment&quot; method is here facilitated, that is, transfer of titles(=bitcoins) from holder to holder is <em>not</em> anyhow taken into account. This allows to stay away from the intricacies of the key-address machinery surrounding commitments in the ZeroCash cryptographic flow.</p></li>
<li><p>Except for the Prover(=Holder) and Verifier, a third party, the <em>Issuer</em>, is involved in the generation of the Holder's commitment: contrary to a bitcoin's serial number, a title's serial number, to which the Holder commits, is not chosen by the Holder themselves but given to them by the Issuer of the title. Note however that this involvement does <em>not</em> violate requirement 4.: it takes place <em>prior to</em> the generation and transmission of the zk-SNARK proof of possession (the single communication step mentioned in 3.), i.e., the Issuer is restricted to only determining the public instance of that proof.</p></li>
</ol>
<p>It should be finally stressed that the here proposed protocol does not intend to replace the <em>ZK-Decryptor Protocol</em>, being rather complementary to it in the context of a <em>Diplomata</em> application. In fact, the <em>ZK-Decryptor</em> setup is a partial prerequisite of our protocol, since the latter will need to utilize the Holder's private key in generating commitments on top of an El-Gamal cryptosystem.</p>
<h2 id="the-anonymous-proof-of-possession-protocol">The Anonymous Proof of Possession Protocol</h2>
<h3 id="preliminaries">Preliminaries</h3>
<p>We expose here the cryptographic flow we want to achieve in view of the requirements 1-4.</p>
<h4 id="commitment-mechanism">Commitment mechanism</h4>
<h4 id="anonymization-and-the-public-predicate">Anonymization and the public predicate</h4>
<h3 id="protocol-description">Protocol description</h3>
<h4 id="setup">Setup</h4>
<h4 id="cryptographic-flow">Cryptographic flow</h4>
<p>Let <span class="math inline">\(t\)</span> be a title held by a Holder <span class="math inline">\(H\)</span> and issued by Issuer <span class="math inline">\(I\)</span>. In order for <span class="math inline">\(H\)</span> to be able to anonymously prove possession of <span class="math inline">\(t\)</span> at any future moment, the following Steps 1-3 must take place (once per t).</p>
<ol style="list-style-type: decimal">
<li><p>Upon issuance of <span class="math inline">\(t\)</span>, <span class="math inline">\(I\)</span> uniquely assigns to it a serial number <span class="math inline">\(s\)</span>, which is recorded to the public ledger and privately communicated to <span class="math inline">\(H\)</span>.</p></li>
<li><p><span class="math inline">\(H\)</span> requests from <span class="math inline">\(I\)</span> to record their commitment to <span class="math inline">\(s\)</span> in the public ledger. In particular, <span class="math inline">\(H\)</span> chooses a secret trapdoor <span class="math inline">\(r\)</span> and computes a commitment <span class="math display">\[c = Comm(r, s)\]</span> which they privately communicate to <span class="math inline">\(I\)</span>. Note that this commitment is generated once per <span class="math inline">\(t\)</span> and will be used in any subsequent prove-verify session concerning this title.</p></li>
<li><p>Being the issuer of <span class="math inline">\(t\)</span>, <span class="math inline">\(I\)</span> approves <span class="math inline">\(H\)</span>'s commitment to <span class="math inline">\(s\)</span> and appends it to the public ledger. Note that only the issuer <span class="math inline">\(I\)</span> of <span class="math inline">\(t\)</span> should be able to approve <span class="math inline">\(c\)</span> and append it to the public ledger. That is, in the cryptocurrency terminology, approval on behalf of <span class="math inline">\(I\)</span> is equivalent to the <span class="math inline">\(H\)</span> having spent 1 BTC to an escrow pool. Note that <span class="math inline">\(H\)</span> can anytime check whether <span class="math inline">\(c\)</span> has indeed been recorded, since the ledger is public.</p></li>
</ol>
<h3 id="performance-and-storage-optimization">Performance and storage optimization</h3>
<h4 id="optimizing-proof-generation">Optimizing proof generation</h4>
<h4 id="optimizing-verification">Optimizing verification</h4>
<h2 id="appendix">Appendix</h2>
<h3 id="a-generic-zk-snark-scheme">A Generic zk-SNARK scheme</h3>
<h3 id="b-merkle-proof-of-inclusion">B Merkle-proof of inclusion</h3>
</body>
</html>
